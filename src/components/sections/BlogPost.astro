---
import { Formatter } from '@utils/formatter.ts';
import type { CollectionEntry } from 'astro:content';

interface Props {
    post: CollectionEntry<'posts'>;
}

const { post } = Astro.props;
const frontmatter = post.data;

---

<article
    class="card bg-base-100 shadow-lg hover:shadow-2xl transition-all duration-300 hover:-translate-y-1 h-full flex flex-col group overflow-hidden border border-base-200"
>
    <!-- Imagen del post -->
    <a href={`/blog/${post.data.slug}`} class="block relative aspect-video overflow-hidden">
        <img
            class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
            src={frontmatter.image
                ? frontmatter.image
                : '/images/placeholder-image.png'}
            alt={frontmatter.title}
        />
        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
    </a>

    <!-- Contenido del post -->
    <div class="card-body p-5 flex flex-col flex-grow">
        
        <!-- Tags -->
        {
            frontmatter.tags && frontmatter.tags.length > 0 && (
                <div class="flex flex-wrap gap-2 mb-2">
                    {frontmatter.tags.slice(0, 3).map((tag: string) => (
                        <span class="badge badge-sm badge-neutral text-xs font-medium opacity-80">
                            #{tag}
                        </span>
                    ))}
                    {frontmatter.tags.length > 3 && (
                        <span class="text-xs text-base-content/60 flex items-center">
                            +{frontmatter.tags.length - 3}
                        </span>
                    )}
                </div>
            )
        }

        <!-- Título -->
        <h2 class="card-title text-lg font-bold leading-tight mb-2 group-hover:text-primary transition-colors">
            <a href={`/blog/${post.data.slug}`} class="line-clamp-2">
                {frontmatter.title}
            </a>
        </h2>

         <!-- Fecha y autor -->
         <div class="flex items-center gap-2 text-xs text-base-content/60 mb-3">
            <time datetime={frontmatter.date} class="flex items-center gap-1">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
                {Formatter.formatDate(frontmatter.date)}
            </time>
            {frontmatter.author && (
                <>
                    <span>•</span>
                    <span class="flex items-center gap-1">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                        {frontmatter.author}
                    </span>
                </>
            )}
        </div>


        <!-- Descripción -->
        <p class="text-sm text-base-content/80 line-clamp-3 mb-4 flex-grow">
            {frontmatter.description}
        </p>

        <!-- Botón leer más - Estilo consistente con branding iqEngi -->
        <div class="card-actions justify-end mt-auto pt-4 border-t border-base-200">
            <a
                href={`/blog/${post.data.slug}`}
                class="btn btn-primary h-10 min-h-[40px] w-full text-white shadow-md shadow-primary/20 hover:bg-[var(--color-btn-hover)] hover:border-[var(--color-btn-hover)] hover:shadow-lg hover:shadow-[var(--color-btn-hover)]/40 hover:scale-[1.02] rounded-xl transition-all duration-300 group/btn"
            >
                Leer artículo
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1 transition-transform group-hover/btn:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                </svg>
            </a>
        </div>
    </div>
</article>
